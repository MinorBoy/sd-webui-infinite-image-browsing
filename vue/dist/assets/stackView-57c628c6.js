import{d as ae,u as he,g as ee,_ as Oe,c as a,a as ke,P as pe,D as it,f as Ue,w as ut,b as dt,e as ct,h as Ee,M as be,i as pt,j as mt,F as Ce,o as d,k as $,l as u,m as q,t as c,n as ce,p as O,q as We,r as ft,s as ze,v as je,x as vt,y as _t,z as Te,A as D,B as l,C as m,E as e,G as K,H as gt,I as ge,J as kt,K as bt,L as Ct,N as yt,S as ht,O as wt,Q as It,R as $t,T as Ve,U as St,V as Pt,W as Ft,X as At,Y as Mt,Z as Bt,$ as Rt}from"./index-e82e9f1c.js";import{S as te,s as xt,f as Nt}from"./fullScreenContextMenu-7792ff59.js";import{F as U,N as Dt,_ as Et,a as zt}from"./numInput-58f28092.js";import"./index-801ff788.js";import{D as Ge}from"./index-96e7b26a.js";/* empty css              *//* empty css              */import{u as jt,a as Tt,b as Vt,c as Lt,d as Ot,e as Ut,f as Wt,s as Gt,g as Kt,F as qt}from"./FileItem-3c183d4e.js";import"./functionalCallableComp-4ee97acb.js";var Qt=["class","style"],Ht=function(){return{prefixCls:String,href:String,separator:pe.any,overlay:pe.any,onClick:Function}};const ne=ae({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Ht(),slots:["separator","overlay"],setup:function(r,h){var _=h.slots,k=h.attrs,P=he("breadcrumb",r),y=P.prefixCls,M=function(F,f){var i=ee(_,r,"overlay");return i?a(Ge,{overlay:i,placement:"bottom"},{default:function(){return[a("span",{class:"".concat(f,"-overlay-link")},[F,a(it,null,null)])]}}):F};return function(){var B,F=(B=ee(_,r,"separator"))!==null&&B!==void 0?B:"/",f=ee(_,r),i=k.class,b=k.style,g=Oe(k,Qt),v;return r.href!==void 0?v=a("a",ke({class:"".concat(y.value,"-link"),onClick:r.onClick},g),[f]):v=a("span",ke({class:"".concat(y.value,"-link"),onClick:r.onClick},g),[f]),v=M(v,y.value),f?a("span",{class:i,style:b},[v,F&&a("span",{class:"".concat(y.value,"-separator")},[F])]):null}}});var Jt=function(){return{prefixCls:String,routes:{type:Array},params:pe.any,separator:pe.any,itemRender:{type:Function}}};function Xt(s,r){if(!s.breadcrumbName)return null;var h=Object.keys(r).join("|"),_=s.breadcrumbName.replace(new RegExp(":(".concat(h,")"),"g"),function(k,P){return r[P]||k});return _}function Le(s){var r=s.route,h=s.params,_=s.routes,k=s.paths,P=_.indexOf(r)===_.length-1,y=Xt(r,h);return P?a("span",null,[y]):a("a",{href:"#/".concat(k.join("/"))},[y])}const Q=ae({compatConfig:{MODE:3},name:"ABreadcrumb",props:Jt(),slots:["separator","itemRender"],setup:function(r,h){var _=h.slots,k=he("breadcrumb",r),P=k.prefixCls,y=k.direction,M=function(i,b){return i=(i||"").replace(/^\//,""),Object.keys(b).forEach(function(g){i=i.replace(":".concat(g),b[g])}),i},B=function(i,b,g){var v=pt(i),A=M(b||"",g);return A&&v.push(A),v},F=function(i){var b=i.routes,g=b===void 0?[]:b,v=i.params,A=v===void 0?{}:v,x=i.separator,E=i.itemRender,z=E===void 0?Le:E,j=[];return g.map(function(w){var T=M(w.path,A);T&&j.push(T);var H=[].concat(j),J=null;return w.children&&w.children.length&&(J=a(be,null,{default:function(){return[w.children.map(function(W){return a(be.Item,{key:W.path||W.breadcrumbName},{default:function(){return[z({route:W,params:A,routes:g,paths:B(H,W.path,A)})]}})})]}})),a(ne,{overlay:J,separator:x,key:T||w.breadcrumbName},{default:function(){return[z({route:w,params:A,routes:g,paths:H})]}})})};return function(){var f,i,b,g=r.routes,v=r.params,A=v===void 0?{}:v,x=Ue(ee(_,r)),E=(f=ee(_,r,"separator"))!==null&&f!==void 0?f:"/",z=r.itemRender||_.itemRender||Le;g&&g.length>0?b=F({routes:g,params:A,separator:E,itemRender:z}):x.length&&(b=x.map(function(w,T){return ut(dt(w.type)==="object"&&(w.type.__ANT_BREADCRUMB_ITEM||w.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),ct(w,{separator:E,key:T})}));var j=(i={},Ee(i,P.value,!0),Ee(i,"".concat(P.value,"-rtl"),y.value==="rtl"),i);return a("div",{class:j},[b])}}});var Yt=["separator","class"],Zt=function(){return{prefixCls:String}};const ye=ae({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Zt(),setup:function(r,h){var _=h.slots,k=h.attrs,P=he("breadcrumb",r),y=P.prefixCls;return function(){var M;k.separator;var B=k.class,F=Oe(k,Yt),f=Ue((M=_.default)===null||M===void 0?void 0:M.call(_));return a("span",ke({class:["".concat(y.value,"-separator"),B]},F),[f.length>0?f:"/"])}}});Q.Item=ne;Q.Separator=ye;Q.install=function(s){return s.component(Q.name,Q),s.component(ne.name,ne),s.component(ye.name,ye),s};U.useInjectFormItemContext=mt;U.ItemRest=Ce;U.install=function(s){return s.component(U.name,U),s.component(U.Item.name,U.Item),s.component(Ce.name,Ce),s};te.setDefaultIndicator=xt;te.install=function(s){return s.component(te.name,te),s};const en={class:"base-info"},tn=ae({__name:"BaseFileListInfo",props:{fileNum:{},selectedFileNum:{}},setup(s){return(r,h)=>(d(),$("div",en,[u("span",null,[q(c(r.$t("items",[r.fileNum]))+" ",1),r.selectedFileNum?(d(),$(ce,{key:0},[q(", "+c(r.$t("selectedItems",[r.selectedFileNum])),1)],64)):O("",!0)])]))}});const nn=We(tn,[["__scopeId","data-v-afd25667"]]),an={class:"hint"},on={class:"location-bar"},rn={key:0,class:"breadcrumb"},sn=["onClick"],ln={key:3,class:"location-act"},un={class:"actions"},dn=["onClick"],cn={style:{width:"512px",background:"var(--zp-primary-background)",padding:"16px","border-radius":"4px","box-shadow":"0 0 4px var(--zp-secondary-background)",border:"1px solid var(--zp-secondary-background)"}},pn={style:{padding:"4px"}},mn={style:{padding:"4px"}},fn={style:{padding:"4px"}},vn={key:0,class:"view"},_n={style:{padding:"16px 0 64px"}},gn={key:0,class:"preview-switch"},kn=ae({__name:"stackView",props:{tabIdx:{},paneIdx:{},path:{},walkModePath:{},stackKey:{}},setup(s){const r=s,h=ft(),{scroller:_,stackViewEl:k,props:P,multiSelectedIdxs:y,spinning:M}=jt().toRefs(),{currLocation:B,currPage:F,refresh:f,copyLocation:i,back:b,openNext:g,stack:v,quickMoveTo:A,addToSearchScanPathAndQuickMove:x,searchPathInfo:E,locInputValue:z,isLocationEditing:j,onLocEditEnter:w,onEditBtnClick:T,share:H,selectAll:J,onCreateFloderBtnClick:oe,onWalkBtnClick:W,showWalkButton:we,searchInCurrentDir:Ie}=Tt(),{gridItems:Ke,sortMethodConv:qe,moreActionsDropdownShow:me,sortedFiles:p,sortMethod:fe,itemSize:$e,loadNextDir:Qe,loadNextDirLoading:He,canLoadNext:Je,onScroll:Xe,cellWidth:re}=Vt(),{onDrop:Ye,onFileDragStart:Ze,onFileDragEnd:et}=Lt(),{onFileItemClick:tt,onContextMenuClick:Se,showGenInfo:se,imageGenInfo:Pe,q:Fe}=Ot({openNext:g}),{previewIdx:le,onPreviewVisibleChange:nt,previewing:Ae,previewImgMove:Me,canPreview:Be}=Ut(),{showMenuIdx:ve}=Wt();ze(()=>r,()=>{P.value=r;const o=Gt.get(r.stackKey??"");o&&(v.value=o.slice())},{immediate:!0}),ze(p,async(o,t)=>{o.length>0&&o.length!==t.length&&Re()});const ie=je(!0),_e=je(!1);function Re(){let o=[];const t=[".png",".jpg",".jpeg"];for(let I in p.value)p.value[I].type=="file"&&t.includes(p.value[I].fullpath.slice(-4).toLowerCase())&&o.push(p.value[I].fullpath);Fe.pushAction(()=>vt(o)).res.then(I=>{for(let V in p.value)p.value[V].gen_info_raw=I[p.value[V].fullpath],p.value[V].gen_info_obj=_t(I[p.value[V].fullpath])})}function xe(o,t,I,V){let S={diff:{},empty:!0,ownFile:"",otherFile:""};if(t+I<0||t+I>=p.value.length||p.value[t]==null||!("gen_info_obj"in p.value[t])||!("gen_info_obj"in p.value[t+I]))return S;let L=o,N=p.value[t+I].gen_info_obj;if(N==null)return S;let ue=["hashes","resources"];S.diff={},S.ownFile=V.name,S.otherFile=p.value[t+I].name,S.empty=!1,_e.value||ue.push("seed");for(let C in L)if(!ue.includes(C)){if(!(C in N)){S.diff[C]="+";continue}if(L[C]!=N[C])if(C.includes("rompt")&&L[C]!=""&&N[C]!=""){let X=L[C].split(","),Y=N[C].split(","),Z=0;for(let G in X)X[G]!=Y[G]&&Z++;S.diff[C]=Z}else S.diff[C]=[L[C],N[C]]}return S}return(o,t)=>{const I=St,V=Pt,S=Ft,L=ne,N=Q,ue=At,C=Mt,X=Bt,Y=Rt,Z=be,G=Ge,at=Dt,de=Et,Ne=zt,ot=U,rt=Te("LeftCircleOutlined"),st=Te("RightCircleOutlined"),lt=te;return d(),D(lt,{spinning:e(M),size:"large"},{default:l(()=>[a(I,{style:{display:"none"}}),u("div",{ref_key:"stackViewEl",ref:k,onDragover:t[28]||(t[28]=m(()=>{},["prevent"])),onDrop:t[29]||(t[29]=m(n=>e(Ye)(n),["prevent"])),class:"container"},[a(S,{visible:e(se),"onUpdate:visible":t[1]||(t[1]=n=>K(se)?se.value=n:null),width:"70vw","mask-closable":"",onOk:t[2]||(t[2]=n=>se.value=!1)},{cancelText:l(()=>[]),default:l(()=>[a(V,{active:"",loading:!e(Fe).isIdle},{default:l(()=>[u("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto","z-index":"9999"},onDblclick:t[0]||(t[0]=n=>e(gt)(e(Pe)))},[u("div",an,c(o.$t("doubleClickToCopy")),1),q(" "+c(e(Pe)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),u("div",on,[r.walkModePath?(d(),$("div",rn,[a(ue,null,{title:l(()=>[q(c(o.$t("walk-mode-move-message")),1)]),default:l(()=>[a(N,{style:{flex:"1"}},{default:l(()=>[(d(!0),$(ce,null,ge(e(v),(n,R)=>(d(),D(L,{key:R},{default:l(()=>[u("span",null,c(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),1)]),_:2},1024))),128))]),_:1})]),_:1})])):(d(),$("div",{key:1,class:"breadcrumb",style:kt({flex:e(j)?1:""})},[e(j)?(d(),D(C,{key:0,style:{flex:"1"},value:e(z),"onUpdate:value":t[3]||(t[3]=n=>K(z)?z.value=n:null),onClick:t[4]||(t[4]=m(()=>{},["stop"])),onKeydown:t[5]||(t[5]=m(()=>{},["stop"])),onPressEnter:e(w),"allow-clear":""},null,8,["value","onPressEnter"])):(d(),D(N,{key:1,style:{flex:"1"}},{default:l(()=>[(d(!0),$(ce,null,ge(e(v),(n,R)=>(d(),D(L,{key:R},{default:l(()=>[u("a",{onClick:m(De=>e(b)(R),["prevent"])},c(n.curr==="/"?o.$t("root"):n.curr.replace(/:\/$/,o.$t("drive"))),9,sn)]),_:2},1024))),128))]),_:1})),e(j)?(d(),D(X,{key:2,size:"small",onClick:e(w),type:"primary"},{default:l(()=>[q(c(o.$t("go")),1)]),_:1},8,["onClick"])):(d(),$("div",ln,[u("a",{onClick:t[6]||(t[6]=m((...n)=>e(i)&&e(i)(...n),["prevent"])),class:"copy"},c(o.$t("copy")),1),u("a",{onClick:t[7]||(t[7]=m((...n)=>e(T)&&e(T)(...n),["prevent","stop"]))},c(o.$t("edit")),1)]))],4)),u("div",un,[u("a",{class:"opt",onClick:t[8]||(t[8]=m((...n)=>e(f)&&e(f)(...n),["prevent"]))},c(o.$t("refresh")),1),a(G,null,{overlay:l(()=>[a(Z,null,{default:l(()=>[a(Y,{key:"tag-search"},{default:l(()=>[u("a",{onClick:t[9]||(t[9]=m(n=>e(Ie)("tag-search"),["prevent"]))},c(o.$t("imgSearch")),1)]),_:1}),a(Y,{key:"tag-search"},{default:l(()=>[u("a",{onClick:t[10]||(t[10]=m(n=>e(Ie)("fuzzy-search"),["prevent"]))},c(o.$t("fuzzy-search")),1)]),_:1})]),_:1})]),_:1}),e(we)?(d(),$("a",{key:0,class:"opt",onClick:t[11]||(t[11]=m((...n)=>e(W)&&e(W)(...n),["prevent"]))}," Walk ")):O("",!0),u("a",{class:"opt",onClick:t[12]||(t[12]=m((...n)=>e(J)&&e(J)(...n),["prevent","stop"]))},c(o.$t("selectAll")),1),e(bt)?O("",!0):(d(),$("a",{key:1,class:"opt",onClick:t[13]||(t[13]=m((...n)=>e(H)&&e(H)(...n),["prevent"]))},c(o.$t("share")),1)),a(G,null,{overlay:l(()=>[a(Z,null,{default:l(()=>[(d(!0),$(ce,null,ge(e(h).quickMovePaths,n=>(d(),D(Y,{key:n.dir},{default:l(()=>[u("a",{onClick:m(R=>e(A)(n.dir),["prevent"])},c(n.zh),9,dn)]),_:2},1024))),128))]),_:1})]),_:1}),a(G,{trigger:["click"],visible:e(me),"onUpdate:visible":t[24]||(t[24]=n=>K(me)?me.value=n:null),placement:"bottomLeft",getPopupContainer:n=>n.parentNode},{overlay:l(()=>[u("div",cn,[a(ot,Ct(yt({labelCol:{span:10},wrapperCol:{span:14}})),{default:l(()=>[a(de,{label:o.$t("gridCellWidth")},{default:l(()=>[a(at,{modelValue:e(re),"onUpdate:modelValue":t[15]||(t[15]=n=>K(re)?re.value=n:null),max:1024,min:64,step:64},null,8,["modelValue"])]),_:1},8,["label"]),a(de,{label:o.$t("sortingMethod")},{default:l(()=>[a(e(ht),{value:e(fe),"onUpdate:value":t[16]||(t[16]=n=>K(fe)?fe.value=n:null),onClick:t[17]||(t[17]=m(()=>{},["stop"])),conv:e(qe),options:e(wt)},null,8,["value","conv","options"])]),_:1},8,["label"]),a(de,{label:o.$t("showChangeIndicators")},{default:l(()=>[a(Ne,{checked:ie.value,"onUpdate:checked":t[18]||(t[18]=n=>ie.value=n),onClick:Re},null,8,["checked"])]),_:1},8,["label"]),a(de,{label:o.$t("seedAsChange")},{default:l(()=>[a(Ne,{checked:_e.value,"onUpdate:checked":t[19]||(t[19]=n=>_e.value=n),disabled:!ie.value},null,8,["checked","disabled"])]),_:1},8,["label"]),u("div",pn,[e(E)?e(E).can_delete?(d(),$("a",{key:1,onClick:t[21]||(t[21]=m((...n)=>e(x)&&e(x)(...n),["prevent"]))},c(o.$t("removeFromSearchScanPathAndQuickMove")),1)):O("",!0):(d(),$("a",{key:0,onClick:t[20]||(t[20]=m((...n)=>e(x)&&e(x)(...n),["prevent"]))},c(o.$t("addToSearchScanPathAndQuickMove")),1))]),u("div",mn,[u("a",{onClick:t[22]||(t[22]=m(n=>e(It)(e(B)+"/"),["prevent"]))},c(o.$t("openWithLocalFileBrowser")),1)]),u("div",fn,[u("a",{onClick:t[23]||(t[23]=m((...n)=>e(oe)&&e(oe)(...n),["prevent"]))},c(o.$t("createFolder")),1)])]),_:1},16)])]),default:l(()=>[u("a",{class:"opt",onClick:t[14]||(t[14]=m(()=>{},["prevent"]))},c(o.$t("more")),1)]),_:1},8,["visible","getPopupContainer"])])]),e(F)?(d(),$("div",vn,[a(e(Kt),{class:"file-list",items:e(p),ref_key:"scroller",ref:_,onScroll:e(Xe),"item-size":e($e).first,"key-field":"fullpath","item-secondary-size":e($e).second,gridItems:e(Ke)},{default:l(({item:n,index:R})=>[a(qt,{idx:parseInt(R),file:n,"full-screen-preview-image-url":e(p)[e(le)]?e($t)(e(p)[e(le)]):"","show-menu-idx":e(ve),"onUpdate:showMenuIdx":t[25]||(t[25]=De=>K(ve)?ve.value=De:null),selected:e(y).includes(R),"cell-width":e(re),onFileItemClick:e(tt),onDragstart:e(Ze),onDragend:e(et),onPreviewVisibleChange:e(nt),onContextMenuClick:e(Se),"is-selected-mutil-files":e(y).length>1,"gen-diff-to-next":xe(n.gen_info_obj,R,1,n),"gen-diff-to-previous":xe(n.gen_info_obj,R,-1,n),"enable-change-indicator":ie.value},null,8,["idx","file","full-screen-preview-image-url","show-menu-idx","selected","cell-width","onFileItemClick","onDragstart","onDragend","onPreviewVisibleChange","onContextMenuClick","is-selected-mutil-files","gen-diff-to-next","gen-diff-to-previous","enable-change-indicator"])]),after:l(()=>[u("div",_n,[r.walkModePath?(d(),D(X,{key:0,onClick:e(Qe),loading:e(He),block:"",type:"primary",disabled:!e(Je),ghost:""},{default:l(()=>[q(c(o.$t("loadNextPage")),1)]),_:1},8,["onClick","loading","disabled"])):O("",!0)])]),_:1},8,["items","onScroll","item-size","item-secondary-size","gridItems"]),e(Ae)?(d(),$("div",gn,[a(rt,{onClick:t[26]||(t[26]=n=>e(Me)("prev")),class:Ve({disable:!e(Be)("prev")})},null,8,["class"]),a(st,{onClick:t[27]||(t[27]=n=>e(Me)("next")),class:Ve({disable:!e(Be)("next")})},null,8,["class"])])):O("",!0)])):O("",!0)],544),e(Ae)?(d(),D(Nt,{key:0,file:e(p)[e(le)],idx:e(le),onContextMenuClick:e(Se)},null,8,["file","idx","onContextMenuClick"])):O("",!0),a(nn,{"file-num":e(p).length,"selected-file-num":e(y).length},null,8,["file-num","selected-file-num"])]),_:1},8,["spinning"])}}});const Fn=We(kn,[["__scopeId","data-v-3ec7b5e9"]]);export{Fn as default};
